# 运算符和函数

运算符可以看成函数，也可以重载：和运算符原有的含义不同。但不能定义新的运算符。运算符作用域内置类型的行为不能修改，3*2必须等于6。

- `+`号可以连接两个字符串
- `[]`可以访问元素
- `/`在`path`类中连接路径元素

其他：`include<cmath>`表示库来自C语言。

一般变量的名字应该与变量的类型相同，通过变量名容易读懂类型。

# 运算符函数

运算符重载会更加直观，如：`v1.compare(v2)`写成`v1 < v2`更加直观。重载运算符优先级不变，不能创造新的运算符。

可重载运算符：
- 类型转换，int，double，甚至某个类转换成int
- 内存分配与归还，new，delete
- 用户自定义字面量运算符，`""_`suffix组成
- 一般运算符

不可重载：
- `a.b()`的`.`
- `.*`
- 作用域运算符`::`
- 三元运算符`?:`
- 预编译处理符`#`
- `sizeof()`被当作运算符，不能重载

`v1 < v2`等价于`v1.operator<(v2)`，运算符`operator<()`这个函数属于`v1`对象，括号内是参数。

# 左值，纯右值与将亡值

C++表达式的分类，通俗理解：
- 能放在等号左边的是左值
- 只能放在等号右边的是右值
- 左值可以作为右值使用

## 左值

C++11中的左值：左值指定了函数或对象，是一个表达式，可以取地址；能取地址就是左值。左值例子：
- 解引用表达式：(*p)
- 字符串字面量，字符串首地址
- 前置自增/自减表达式，先对`i`自增，然后取`i`的值，能取出地址。后置不行
- 赋值或复合运算表达式都可以取地址

## 纯右值

纯右值：不和对象相关联的值(除字符串字面量外的其他字面量， `32`， `a`等)；返回非引用类型的函数调用；匿名的临时对象；后置自增自减(先取地址，然后自增)；算术(`a+b`)、逻辑(`a||b`)和关系表达式(`a<b`)；取地址(`&x`)；左值可以当成右值使用。

## 将亡值

将亡值：表达式，将纯右值转化为右值引用的表达式。

左值引用的例子：
```C++
int a = 1;
int& b = a;
```
`a`是左值，`b`是左值引用。

- `int& l{22}`错误，非常量左值引用不能引用纯右值
- `const int&l {22}`正确，常量左值引用能引用纯右值
- 右值引用可以引用纯右值，`int&& l{22}`
- 右值引用可以引返回纯右值的函数，`int&& l{pre(x)};`，延长变量的生存期
- 右值引用可以用作左值使用，`l = ++l;`

# 重载一般二元算术运算符

加减乘除等。double + Vec2D 不能重载运算符(没有`doube.operator()+`)，友元函数实现，接收两个参数。对于 + - * / 这四个运算符而言，一般情况下，重载这四个运算符后，运算符函数的返回值类型不可以是左值引用类型(没法取地址)。

# 重载复合二元算术运算符

`+=, -=, *=, /=`。`v1 += v2`执行后，`v1`的值发生改变，所以要返回`*this`。

# 重载数组下标运算符

类似数组语法的格式访问、修改(运算符函数类型变引用类型)对象的内容。

# 重载一元运算符

前置的一元运算符：负号、解引用。如果是类的成员，就调用类的成员函数，参数为空；如果是友元函数，传递调用的参数。

# 重载自增自减运算符

- 前置：先增减，后取值，是左值，无参数，返回引用类型即对象本身
- 后置：先取值，后增减，是纯右值返回临时对象，带参数，dummy参数，值是几无所谓，指明后置

类外定义友元函数的话，需要额外传入对象的引用。