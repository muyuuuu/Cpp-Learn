# 异常处理

`try-throw-catch`，`try`中执行保护代码，`throw`扔出异常，`catch`捕获异常。试试扔点啥，看看能否抓住。

优势：可以放到子函数中返回信息并抓住，问题交给主函数处理。可以明确的返回异常，或者添加第三个参数(不优雅)。

# 异常匹配和异常类

`catch(ExceptionType& para)`，引用传参省去值拷贝。类型匹配，就去后面处理异常；对异常内容不感兴趣，可以只保留异常类型。

`new`对应的异常是`bad_alloc`，分配内存时出错。

除了内置类型的异常，还可以有自定义的类的异常，扔出一个类，能捕获的信息会更多。

# 内建异常类

标准库所有异常类的基类：`exception`，包括构造函数、`const char* what()`虚函数(返回解释性字符串)，返回的指针指向解释信息的空终止字符串的指针，覆写时，保证异常对象被销毁前这个指针指向的内容合法。

异常类的种类：逻辑错误(数组越界)、运行时错误(数的范围出错)，这俩个包含在`stdexcept`头文件中。还有其他的类型错误，转换错误等。

代码示例：

- 越界异常
- 内存分配异常
- 侧向转换异常

# 自定义异常类

通常由`exception`（不接受参数）或其他后代类（大多接收字符串参数）派生，而不是从头写。

1. 继承父类
2. 记录异常信息，在构造函数中记录；初始化父类


# 捕获多种无关异常

多次使用`catch`，所以不一定每个`catch`都会执行，可以抛出多种对象。

## 捕获派生异常

某一个类下面对应的多种异常都要抓住，既能捕获派生类，也能捕获基类。

`dynamic_cast`传入对象是指针类型，转换失败返回`nullptr`；如果传入参数是引用类型，转换抛出返回`bad_cast`异常。

继承链中异常的处理次序十分重要：派生类在前，基类在后。因为，如果基类在前，能捕获任何异常；如果派生类在前，不能捕获基类异常。